(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[68],{1914:function(e,a,t){Promise.resolve().then(t.bind(t,3570)),Promise.resolve().then(t.bind(t,1566))},3570:function(e,a,t){"use strict";var r=t(7437),l=t(2265),n=t(5895),i=t(6886),o=t(9733);a.default=()=>{let[e,a]=(0,l.useState)("alerta"),[t,s]=(0,l.useState)(""),[d,c]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),[h,f]=(0,l.useState)(""),[v,p]=(0,l.useState)(null),[b,x]=(0,l.useState)(""),[g,j]=(0,l.useState)(!1),[y,N]=(0,l.useState)([]);(0,l.useEffect)(()=>{m(localStorage.getItem("userId"))},[]),console.log("incidentesData: ",i);let w=async a=>{a.preventDefault();let r={id:Math.floor(999999*Math.random()),tipo:e,subtipo:"alerta"===e?t:void 0,heladeraId:d,fechaHora:new Date,colaboradorId:u,descripcion:"fallaTecnica"===e?h:void 0,foto:"fallaTecnica"===e&&v?URL.createObjectURL(v):void 0,visitas:[],solucionado:!1};try{let e=await fetch("/api/incidentes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await e.json();e.ok?(j(!1),x(a.mensaje),S(),await F(Number(r.heladeraId),"Inactiva")):(j(!0),x(a.mensaje||"Error al enviar el incidente"))}catch(e){console.error("Error al enviar el incidente:",e),x("Error al enviar el incidente")}},S=()=>{c(""),m(""),f(""),p(null),s(""),a("alerta")},F=async(e,a)=>{let t=n.find(a=>a.id===e);try{await fetch("/api/heladeras",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,estado:a})})}catch(e){console.error("Error al editar la heladera:",e)}},k=async e=>{let a=i.find(a=>a.id===e);try{(await fetch("/api/incidentes",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,solucionado:!0})})).ok&&F(Number(null==a?void 0:a.heladeraId),"Activa")}catch(e){console.error("Error al editar el incidente:",e),x("Error al editar el incidente")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:w,className:"flex flex-col gap-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Formulario de Incidentes"}),b&&(0,r.jsx)("div",{className:g?"text-red-600":"text-green-600",children:b}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"tipoIncidente",className:"block text-sm font-medium",children:"Tipo de Incidente:"}),(0,r.jsxs)("select",{id:"tipoIncidente",value:e,onChange:e=>{a(e.target.value)},className:"mt-1 p-2 border rounded-md w-full",children:[(0,r.jsx)("option",{value:"alerta",children:"Alerta"}),(0,r.jsx)("option",{value:"fallaTecnica",children:"Falla T\xe9cnica"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"heladera",className:"block text-sm font-medium",children:"Heladera:"}),(0,r.jsxs)("select",{id:"heladera",value:d,onChange:e=>c(e.target.value),required:!0,className:"mt-1 p-2 border rounded-md w-full",children:[(0,r.jsx)("option",{value:"",children:"Seleccione una Heladera"}),n.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),"alerta"===e&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"subtipoAlerta",className:"block text-sm font-medium",children:"Subtipo de Alerta:"}),(0,r.jsxs)("select",{id:"subtipoAlerta",value:t,onChange:e=>s(e.target.value),required:!0,className:"mt-1 p-2 border rounded-md w-full",children:[(0,r.jsx)("option",{value:"",children:"Seleccione un Subtipo"}),(0,r.jsx)("option",{value:"temperatura",children:"Temperatura"}),(0,r.jsx)("option",{value:"fraude",children:"Fraude"}),(0,r.jsx)("option",{value:"falla en conexi\xf3n",children:"Falla en Conexi\xf3n"})]})]}),"fallaTecnica"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"descripcionFalla",className:"block text-sm font-medium",children:"Descripci\xf3n de la Falla:"}),(0,r.jsx)("textarea",{id:"descripcionFalla",className:"mt-1 p-2 border rounded-md w-full",value:h,onChange:e=>f(e.target.value),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"fotoFalla",className:"block text-sm font-medium",children:"Foto de la Falla:"}),(0,r.jsx)("input",{type:"file",id:"fotoFalla",className:"mt-1 p-2 border rounded-md w-full",accept:"image/*",onChange:e=>p(e.target.files?e.target.files[0]:null)})]})]}),(0,r.jsx)("button",{className:"mt-4 bg-primary text-white py-2 rounded-md hover:bg-primary-dark",type:"submit",disabled:!("alerta"===e?""!==d&&""!==t&&""!==u:""!==d&&""!==u&&""!==h),children:"Enviar"})]}),(0,r.jsxs)("section",{className:"mt-5",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-5",children:"Incidentes Reportados"}),(0,r.jsx)("ul",{className:"list-disc pl-5",children:i.map(e=>{var a;return(0,r.jsxs)("li",{className:"flex justify-between items-center mb-2",children:[e.tipo," - Heladera:"," ",null===(a=n.find(a=>a.id===Number(e.heladeraId)))||void 0===a?void 0:a.nombre,(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsx)(o.z,{onClick:()=>{k(e.id)},className:"w-auto",disabled:e.solucionado,children:e.solucionado?"Incidente Solucionado":"Marcar como Solucionado"})})]},e.id)})})]})]})}},9733:function(e,a,t){"use strict";t.d(a,{z:function(){return d}});var r=t(7437),l=t(2265),n=t(1538),i=t(2218),o=t(9354);let s=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,a)=>{let{className:t,variant:l,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,r.jsx)(u,{className:(0,o.cn)(s({variant:l,size:i,className:t})),ref:a,...c})});d.displayName="Button"},2218:function(e,a,t){"use strict";t.d(a,{j:function(){return n}});let r=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,l=function(){for(var e,a,t=0,r="";t<arguments.length;)(e=arguments[t++])&&(a=function e(a){var t,r,l="";if("string"==typeof a||"number"==typeof a)l+=a;else if("object"==typeof a){if(Array.isArray(a))for(t=0;t<a.length;t++)a[t]&&(r=e(a[t]))&&(l&&(l+=" "),l+=r);else for(t in a)a[t]&&(l&&(l+=" "),l+=t)}return l}(e))&&(r&&(r+=" "),r+=a);return r},n=(e,a)=>t=>{var n;if((null==a?void 0:a.variants)==null)return l(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:i,defaultVariants:o}=a,s=Object.keys(i).map(e=>{let a=null==t?void 0:t[e],l=null==o?void 0:o[e];if(null===a)return null;let n=r(a)||r(l);return i[e][n]}),d=t&&Object.entries(t).reduce((e,a)=>{let[t,r]=a;return void 0===r||(e[t]=r),e},{});return l(e,s,null==a?void 0:null===(n=a.compoundVariants)||void 0===n?void 0:n.reduce((e,a)=>{let{class:t,className:r,...l}=a;return Object.entries(l).every(e=>{let[a,t]=e;return Array.isArray(t)?t.includes({...o,...d}[a]):({...o,...d})[a]===t})?[...e,t,r]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}}},function(e){e.O(0,[310,927,704,653,971,23,744],function(){return e(e.s=1914)}),_N_E=e.O()}]);